<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.ProEmployeeMapper">
    <resultMap id="BaseResultMap" type="models.ProEmployee">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" jdbcType="CHAR" property="id"/>
        <result column="hht_member_id" jdbcType="CHAR" property="hhtMemberId"/>
        <result column="company_id" jdbcType="CHAR" property="companyId"/>
        <result column="employee_no" jdbcType="VARCHAR" property="employeeNo"/>
        <result column="employee_code" jdbcType="VARCHAR" property="employeeCode"/>
        <result column="employee_name" jdbcType="VARCHAR" property="employeeName"/>
        <result column="nationality_id" jdbcType="CHAR" property="nationalityId"/>
        <result column="paper_type_id" jdbcType="CHAR" property="paperTypeId"/>
        <result column="paper_no" jdbcType="VARCHAR" property="paperNo"/>
        <result column="birthday" jdbcType="DATE" property="birthday"/>
        <result column="gender" jdbcType="VARCHAR" property="gender"/>
        <result column="mobile_no" jdbcType="VARCHAR" property="mobileNo"/>
        <result column="tel_no" jdbcType="VARCHAR" property="telNo"/>
        <result column="email" jdbcType="VARCHAR" property="email"/>
        <result column="home_addr" jdbcType="VARCHAR" property="homeAddr"/>
        <result column="head_portrait" jdbcType="VARCHAR" property="headPortrait"/>
        <result column="first_entry_time" jdbcType="BIGINT" property="firstEntryTime"/>
        <result column="last_entry_time" jdbcType="BIGINT" property="lastEntryTime"/>
        <result column="last_leave_time" jdbcType="BIGINT" property="lastLeaveTime"/>
        <result column="enable" jdbcType="CHAR" property="enable"/>
        <result column="creator_id" jdbcType="CHAR" property="creatorId"/>
        <result column="modifier_id" jdbcType="CHAR" property="modifierId"/>
        <result column="locked" jdbcType="CHAR" property="locked"/>
        <result column="locked_reason" jdbcType="VARCHAR" property="lockedReason"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="dr" jdbcType="CHAR" property="dr"/>
        <result column="ts" jdbcType="BIGINT" property="ts"/>
        <result column="version" jdbcType="INTEGER" property="version"/>
    </resultMap>
    <resultMap id="positionResultMap" type="models.vo.ProEmployeeVo">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" jdbcType="CHAR" property="id"/>
        <result column="hht_member_id" jdbcType="CHAR" property="hhtMemberId"/>
        <result column="company_id" jdbcType="CHAR" property="companyId"/>
        <result column="employee_no" jdbcType="VARCHAR" property="employeeNo"/>
        <result column="employee_code" jdbcType="VARCHAR" property="employeeCode"/>
        <result column="employee_name" jdbcType="VARCHAR" property="employeeName"/>
        <result column="nationality_id" jdbcType="CHAR" property="nationalityId"/>
        <result column="paper_type_id" jdbcType="CHAR" property="paperTypeId"/>
        <result column="paper_no" jdbcType="VARCHAR" property="paperNo"/>
        <result column="birthday" jdbcType="DATE" property="birthday"/>
        <result column="gender" jdbcType="VARCHAR" property="gender"/>
        <result column="mobile_no" jdbcType="VARCHAR" property="mobileNo"/>
        <result column="tel_no" jdbcType="VARCHAR" property="telNo"/>
        <result column="email" jdbcType="VARCHAR" property="email"/>
        <result column="home_addr" jdbcType="VARCHAR" property="homeAddr"/>
        <result column="head_portrait" jdbcType="VARCHAR" property="headPortrait"/>
        <result column="first_entry_time" jdbcType="BIGINT" property="firstEntryTime"/>
        <result column="last_entry_time" jdbcType="BIGINT" property="lastEntryTime"/>
        <result column="last_leave_time" jdbcType="BIGINT" property="lastLeaveTime"/>
        <result column="enable" jdbcType="CHAR" property="enable"/>
        <result column="creator_id" jdbcType="CHAR" property="creatorId"/>
        <result column="modifier_id" jdbcType="CHAR" property="modifierId"/>
        <result column="locked" jdbcType="CHAR" property="locked"/>
        <result column="locked_reason" jdbcType="VARCHAR" property="lockedReason"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="dr" jdbcType="CHAR" property="dr"/>
        <result column="ts" jdbcType="BIGINT" property="ts"/>
        <result column="version" jdbcType="INTEGER" property="version"/>
        <result column="shop_id" jdbcType="VARCHAR" property="shopId"/>
        <result column="shop_name" jdbcType="VARCHAR" property="shopName"/>
        <collection property="positionNames" resultMap="positions"/>
    </resultMap>
    <resultMap id="positions" type="models.ProPosition">
        <id column="position_id" jdbcType="CHAR" property="id"/>
        <result column="position_name" jdbcType="VARCHAR" property="positionName"/>
    </resultMap>

    <resultMap id="LoginMap" type="models.vo.LoginEmployeeVo">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" jdbcType="CHAR" property="id"/>
        <result column="hht_member_id" jdbcType="CHAR" property="hhtMemberId"/>
        <result column="company_id" jdbcType="CHAR" property="companyId"/>
        <result column="employee_no" jdbcType="VARCHAR" property="employeeNo"/>
        <result column="employee_code" jdbcType="VARCHAR" property="employeeCode"/>
        <result column="employee_name" jdbcType="VARCHAR" property="employeeName"/>
        <result column="nationality_id" jdbcType="CHAR" property="nationalityId"/>
        <result column="paper_type_id" jdbcType="CHAR" property="paperTypeId"/>
        <result column="paper_no" jdbcType="VARCHAR" property="paperNo"/>
        <result column="birthday" jdbcType="DATE" property="birthday"/>
        <result column="gender" jdbcType="VARCHAR" property="gender"/>
        <result column="mobile_no" jdbcType="VARCHAR" property="mobileNo"/>
        <result column="tel_no" jdbcType="VARCHAR" property="telNo"/>
        <result column="email" jdbcType="VARCHAR" property="email"/>
        <result column="home_addr" jdbcType="VARCHAR" property="homeAddr"/>
        <result column="head_portrait" jdbcType="VARCHAR" property="headPortrait"/>
        <result column="first_entry_time" jdbcType="BIGINT" property="firstEntryTime"/>
        <result column="last_entry_time" jdbcType="BIGINT" property="lastEntryTime"/>
        <result column="last_leave_time" jdbcType="BIGINT" property="lastLeaveTime"/>
        <result column="enable" jdbcType="CHAR" property="enable"/>
        <result column="creator_id" jdbcType="CHAR" property="creatorId"/>
        <result column="modifier_id" jdbcType="CHAR" property="modifierId"/>
        <result column="locked" jdbcType="CHAR" property="locked"/>
        <result column="locked_reason" jdbcType="VARCHAR" property="lockedReason"/>
        <result column="remark" jdbcType="VARCHAR" property="remark"/>
        <result column="dr" jdbcType="CHAR" property="dr"/>
        <result column="ts" jdbcType="BIGINT" property="ts"/>
        <result column="version" jdbcType="INTEGER" property="version"/>
        <result column="shop_id" jdbcType="VARCHAR" property="shopId"/>
        <result column="shop_name" jdbcType="VARCHAR" property="shopName"/>
        <result column="position_name" jdbcType="VARCHAR" property="positionName"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id, hht_member_id, company_id, employee_no, employee_code, employee_name, nationality_id,
        paper_type_id, paper_no, birthday, gender, mobile_no, tel_no, email, home_addr, head_portrait,
        first_entry_time, last_entry_time, last_leave_time, enable, creator_id, modifier_id,
        locked, locked_reason, remark, dr, ts, version
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from pro_employee
        where id = #{id,jdbcType=CHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from pro_employee
        where id = #{id,jdbcType=CHAR}
    </delete>
    <insert id="insert" parameterType="models.ProEmployee">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into pro_employee (id, hht_member_id, company_id,
        employee_no, employee_code, employee_name,
        nationality_id, paper_type_id, paper_no,
        birthday, gender, mobile_no,
        tel_no, email, home_addr,
        head_portrait, first_entry_time, last_entry_time,
        last_leave_time, enable, creator_id,
        modifier_id, locked, locked_reason,
        remark, dr, ts, version
        )
        values (#{id,jdbcType=CHAR}, #{hhtMemberId,jdbcType=CHAR}, #{companyId,jdbcType=CHAR},
        #{employeeNo,jdbcType=VARCHAR}, #{employeeCode,jdbcType=VARCHAR}, #{employeeName,jdbcType=VARCHAR},
        #{nationalityId,jdbcType=CHAR}, #{paperTypeId,jdbcType=CHAR}, #{paperNo,jdbcType=VARCHAR},
        #{birthday,jdbcType=DATE}, #{gender,jdbcType=VARCHAR}, #{mobileNo,jdbcType=VARCHAR},
        #{telNo,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{homeAddr,jdbcType=VARCHAR},
        #{headPortrait,jdbcType=VARCHAR}, #{firstEntryTime,jdbcType=BIGINT}, #{lastEntryTime,jdbcType=BIGINT},
        #{lastLeaveTime,jdbcType=BIGINT}, #{enable,jdbcType=CHAR}, #{creatorId,jdbcType=CHAR},
        #{modifierId,jdbcType=CHAR}, #{locked,jdbcType=CHAR}, #{lockedReason,jdbcType=VARCHAR},
        #{remark,jdbcType=VARCHAR}, #{dr,jdbcType=CHAR}, #{ts,jdbcType=BIGINT}, #{version,jdbcType=INTEGER}
        )
    </insert>
    <insert id="insertSelective" parameterType="models.ProEmployee">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into pro_employee
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="hhtMemberId != null">
                hht_member_id,
            </if>
            <if test="companyId != null">
                company_id,
            </if>
            <if test="employeeNo != null">
                employee_no,
            </if>
            <if test="employeeCode != null">
                employee_code,
            </if>
            <if test="employeeName != null">
                employee_name,
            </if>
            <if test="nationalityId != null">
                nationality_id,
            </if>
            <if test="paperTypeId != null">
                paper_type_id,
            </if>
            <if test="paperNo != null">
                paper_no,
            </if>
            <if test="birthday != null">
                birthday,
            </if>
            <if test="gender != null">
                gender,
            </if>
            <if test="mobileNo != null">
                mobile_no,
            </if>
            <if test="telNo != null">
                tel_no,
            </if>
            <if test="email != null">
                email,
            </if>
            <if test="homeAddr != null">
                home_addr,
            </if>
            <if test="headPortrait != null">
                head_portrait,
            </if>
            <if test="firstEntryTime != null">
                first_entry_time,
            </if>
            <if test="lastEntryTime != null">
                last_entry_time,
            </if>
            <if test="lastLeaveTime != null">
                last_leave_time,
            </if>
            <if test="enable != null">
                enable,
            </if>
            <if test="creatorId != null">
                creator_id,
            </if>
            <if test="modifierId != null">
                modifier_id,
            </if>
            <if test="locked != null">
                locked,
            </if>
            <if test="lockedReason != null">
                locked_reason,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="dr != null">
                dr,
            </if>
            <if test="ts != null">
                ts,
            </if>
            <if test="version != null">
                version,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=CHAR},
            </if>
            <if test="hhtMemberId != null">
                #{hhtMemberId,jdbcType=CHAR},
            </if>
            <if test="companyId != null">
                #{companyId,jdbcType=CHAR},
            </if>
            <if test="employeeNo != null">
                #{employeeNo,jdbcType=VARCHAR},
            </if>
            <if test="employeeCode != null">
                #{employeeCode,jdbcType=VARCHAR},
            </if>
            <if test="employeeName != null">
                #{employeeName,jdbcType=VARCHAR},
            </if>
            <if test="nationalityId != null">
                #{nationalityId,jdbcType=CHAR},
            </if>
            <if test="paperTypeId != null">
                #{paperTypeId,jdbcType=CHAR},
            </if>
            <if test="paperNo != null">
                #{paperNo,jdbcType=VARCHAR},
            </if>
            <if test="birthday != null">
                #{birthday,jdbcType=DATE},
            </if>
            <if test="gender != null">
                #{gender,jdbcType=VARCHAR},
            </if>
            <if test="mobileNo != null">
                #{mobileNo,jdbcType=VARCHAR},
            </if>
            <if test="telNo != null">
                #{telNo,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="homeAddr != null">
                #{homeAddr,jdbcType=VARCHAR},
            </if>
            <if test="headPortrait != null">
                #{headPortrait,jdbcType=VARCHAR},
            </if>
            <if test="firstEntryTime != null">
                #{firstEntryTime,jdbcType=BIGINT},
            </if>
            <if test="lastEntryTime != null">
                #{lastEntryTime,jdbcType=BIGINT},
            </if>
            <if test="lastLeaveTime != null">
                #{lastLeaveTime,jdbcType=BIGINT},
            </if>
            <if test="enable != null">
                #{enable,jdbcType=CHAR},
            </if>
            <if test="creatorId != null">
                #{creatorId,jdbcType=CHAR},
            </if>
            <if test="modifierId != null">
                #{modifierId,jdbcType=CHAR},
            </if>
            <if test="locked != null">
                #{locked,jdbcType=CHAR},
            </if>
            <if test="lockedReason != null">
                #{lockedReason,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="dr != null">
                #{dr,jdbcType=CHAR},
            </if>
            <if test="ts != null">
                #{ts,jdbcType=BIGINT},
            </if>
            <if test="version != null">
                #{version,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="models.ProEmployee">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update pro_employee
        <set>
            <if test="hhtMemberId != null">
                hht_member_id = #{hhtMemberId,jdbcType=CHAR},
            </if>
            <if test="companyId != null">
                company_id = #{companyId,jdbcType=CHAR},
            </if>
            <if test="employeeNo != null">
                employee_no = #{employeeNo,jdbcType=VARCHAR},
            </if>
            <if test="employeeCode != null">
                employee_code = #{employeeCode,jdbcType=VARCHAR},
            </if>
            <if test="employeeName != null">
                employee_name = #{employeeName,jdbcType=VARCHAR},
            </if>
            <if test="nationalityId != null">
                nationality_id = #{nationalityId,jdbcType=CHAR},
            </if>
            <if test="paperTypeId != null">
                paper_type_id = #{paperTypeId,jdbcType=CHAR},
            </if>
            <if test="paperNo != null">
                paper_no = #{paperNo,jdbcType=VARCHAR},
            </if>
            <if test="birthday != null">
                birthday = #{birthday,jdbcType=DATE},
            </if>
            <if test="gender != null">
                gender = #{gender,jdbcType=VARCHAR},
            </if>
            <if test="mobileNo != null">
                mobile_no = #{mobileNo,jdbcType=VARCHAR},
            </if>
            <if test="telNo != null">
                tel_no = #{telNo,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                email = #{email,jdbcType=VARCHAR},
            </if>
            <if test="homeAddr != null">
                home_addr = #{homeAddr,jdbcType=VARCHAR},
            </if>
            <if test="headPortrait != null">
                head_portrait = #{headPortrait,jdbcType=VARCHAR},
            </if>
            <if test="firstEntryTime != null">
                first_entry_time = #{firstEntryTime,jdbcType=BIGINT},
            </if>
            <if test="lastEntryTime != null">
                last_entry_time = #{lastEntryTime,jdbcType=BIGINT},
            </if>
            <if test="lastLeaveTime != null">
                last_leave_time = #{lastLeaveTime,jdbcType=BIGINT},
            </if>
            <if test="enable != null">
                enable = #{enable,jdbcType=CHAR},
            </if>
            <if test="creatorId != null">
                creator_id = #{creatorId,jdbcType=CHAR},
            </if>
            <if test="modifierId != null">
                modifier_id = #{modifierId,jdbcType=CHAR},
            </if>
            <if test="locked != null">
                locked = #{locked,jdbcType=CHAR},
            </if>
            <if test="lockedReason != null">
                locked_reason = #{lockedReason,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="dr != null">
                dr = #{dr,jdbcType=CHAR},
            </if>
            <if test="ts != null">
                ts = #{ts,jdbcType=BIGINT},
            </if>
            <if test="version != null">
                version = #{version,jdbcType=INTEGER},
            </if>
        </set>
        where id = #{id,jdbcType=CHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="models.ProEmployee">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update pro_employee
        set hht_member_id = #{hhtMemberId,jdbcType=CHAR},
        company_id = #{companyId,jdbcType=CHAR},
        employee_no = #{employeeNo,jdbcType=VARCHAR},
        employee_code = #{employeeCode,jdbcType=VARCHAR},
        employee_name = #{employeeName,jdbcType=VARCHAR},
        nationality_id = #{nationalityId,jdbcType=CHAR},
        paper_type_id = #{paperTypeId,jdbcType=CHAR},
        paper_no = #{paperNo,jdbcType=VARCHAR},
        birthday = #{birthday,jdbcType=DATE},
        gender = #{gender,jdbcType=VARCHAR},
        mobile_no = #{mobileNo,jdbcType=VARCHAR},
        tel_no = #{telNo,jdbcType=VARCHAR},
        email = #{email,jdbcType=VARCHAR},
        home_addr = #{homeAddr,jdbcType=VARCHAR},
        head_portrait = #{headPortrait,jdbcType=VARCHAR},
        first_entry_time = #{firstEntryTime,jdbcType=BIGINT},
        last_entry_time = #{lastEntryTime,jdbcType=BIGINT},
        last_leave_time = #{lastLeaveTime,jdbcType=BIGINT},
        enable = #{enable,jdbcType=CHAR},
        creator_id = #{creatorId,jdbcType=CHAR},
        modifier_id = #{modifierId,jdbcType=CHAR},
        locked = #{locked,jdbcType=CHAR},
        locked_reason = #{lockedReason,jdbcType=VARCHAR},
        remark = #{remark,jdbcType=VARCHAR},
        dr = #{dr,jdbcType=CHAR},
        ts = #{ts,jdbcType=BIGINT},
        version = #{version,jdbcType=INTEGER}
        where id = #{id,jdbcType=CHAR}
    </update>


    <select id="getEmployeesByMap" resultMap="BaseResultMap" parameterType="java.util.Map">
        select
        e.id, e.company_id, e.employee_no, e.employee_code, e.employee_name, e.nationality_id,
        e.birthday, e.gender, e.mobile_no, e.tel_no, e.email, e.home_addr, e.first_entry_time
        from pro_employee e
        LEFT JOIN pro_employee_shop p
        ON e.id = p.employee_id
        <where>
            e.dr = "N" AND p.dr ='N' AND e.employee_code is not NULL
            <if test="shopId != null">
                AND p.shop_id = #{shopId,jdbcType=VARCHAR}
            </if>
            <if test="employeeName != null">
                AND e.employee_name LIKE #{employeeName,jdbcType=VARCHAR}
            </if>

            <if test="id != null">
                AND e.id not in
                <foreach item="item" index="index" collection="id" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>

        </where>
    </select>

    <select id="queryByCode" parameterType="java.lang.String" resultMap="positionResultMap">
    select
    pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
    pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
    pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
    pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name
    ,pep.shop_id,ps.shop_name,pp.id position_id
    from pro_employee pe
        LEFT JOIN pro_employee_position pep
        ON (pe.id=pep.employee_id  AND pep.dr='N')
    LEFT JOIN
        pro_shop ps ON ps.id = pep.shop_id
        LEFT JOIN pro_position pp
        ON pp.id=pep.position_id
    where pe.employee_no = #{employeeCode,jdbcType=VARCHAR}
    AND pe.dr='N';
  </select>
    <select id="queryForLogin" parameterType="java.lang.String" resultMap="LoginMap">
        select
    pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
    pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
    pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
    pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name
    ,pep.shop_id,ps.shop_name,pp.id position_id
    from pro_employee pe
        LEFT JOIN pro_employee_position pep
        ON (pe.id=pep.employee_id  AND pep.dr='N')
    LEFT JOIN
        pro_shop ps ON ps.id = pep.shop_id
        LEFT JOIN pro_position pp
        ON pp.id=pep.position_id
    where pe.employee_no = #{employeeCode,jdbcType=VARCHAR}
    AND pe.dr='N';
    </select>
    <select id="queryListByCodes" parameterType="java.lang.String" resultMap="positionResultMap">
        select
        pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
        pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
        pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
        pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name
        ,pes.shop_id,ps.shop_name,pp.id position_id
        from pro_employee pe
        LEFT JOIN pro_employee_position pep
        ON (pe.id=pep.employee_id  AND pep.dr='N' AND pep.default_position='Y')
        LEFT JOIN
        pro_position pp
        ON pep.position_id = pp.id
        LEFT JOIN
        pro_employee_shop pes
        ON (pes.employee_id = pe.id AND pes.dr='N')
        LEFT JOIN
        pro_shop ps ON ps.id = pes.shop_id
        where pe.employee_code in
        <foreach collection="list" item="empCode" open="(" close=")"
                 separator=",">
            #{empCode}
        </foreach>
        AND pe.dr='N' AND pp.dr='N'
    </select>



    <select id="getShopManagerByShopId" parameterType="String" resultMap="positionResultMap">
    select
    pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
    pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
    pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
    pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name,pes.shop_id
    from pro_employee pe ,pro_employee_position pep,pro_position pp ,pro_employee_shop pes
    where pes.shop_id = #{shopId,jdbcType=VARCHAR}
    AND pe.id=pep.employee_id AND pep.position_id = pp.id AND pes.employee_id = pe.id
    AND pp.position_name='店经理'
    AND pe.dr='N' AND pp.dr='N' AND pep.dr='N' AND pes.dr='N'
  </select>
    <select id="getCoach" parameterType="String" resultMap="positionResultMap">
         select
        pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
        pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
        pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
        pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name,pes.shop_id
        from pro_employee pe ,pro_employee_position pep,pro_position pp ,pro_employee_shop pes
        where pe.id=pep.employee_id AND pep.position_id = pp.id AND pes.employee_id = pe.id
        AND pp.position_name='新店辅导班'
        AND pe.dr='N' AND pp.dr='N' group by employee_no
    </select>

    <select id="queryListByShopIds" parameterType="java.util.List" resultMap="positionResultMap">
        select
        pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
        pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
        pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
        pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name,pes.shop_id
        from pro_employee pe ,pro_employee_position pep,pro_position pp ,pro_employee_shop pes
        where pes.shop_id in
        <foreach collection="list" item="shopId" open="(" close=")"
                 separator=",">
            #{shopId}
        </foreach>
        AND pe.id=pep.employee_id AND pep.position_id = pp.id AND pes.employee_id = pe.id
        AND pp.position_name='店经理'
        AND pe.dr='N' AND pp.dr='N'
    </select>

    <select id="getEmployeeByEmployeeId" parameterType="java.lang.String" resultType="java.util.Map">

    SELECT
    e.employee_name Name,e.email Email,e.gender Gender,e.mobile_no Mobile, e.birthday Age,e.employee_code ExternalId,
    s.test_id CandidateUniqueId,n.position_name position,sh.shop_name shopName,
    from_unixtime(e.first_entry_time/1000,'%Y-%m-%d') firstTime,
    from_unixtime(e.last_entry_time/1000,'%Y-%m-%d') lastTime,
    e.culture Culture
    FROM pro_employee e
    LEFT JOIN  pro_shop_elite s
    ON e.id = s.employee_id
    LEFT JOIN pro_employee_position pos
    ON e.id = pos.employee_id
    LEFT JOIN pro_shop sh
    ON sh.id = pos.shop_id
    LEFT JOIN pro_position n
    ON n.id = pos.position_id
    WHERE
    e.dr = 'N' AND pos.default_position='Y' AND s.dr = 'N' AND pos.dr = 'N' AND sh.dr = 'N' AND n.dr ='N' AND e.id =  #{id,jdbcType=CHAR}
    GROUP BY e.id


  </select>

    <select id="selectCountByShopId" parameterType="java.lang.String" resultType="java.lang.Integer">

       SELECT
       COUNT(*)
       FROM pro_employee pe ,pro_employee_shop ps
       WHERE pe.id=ps.employee_id
       AND pe.dr='N' AND ps.dr='N'
       AND ps.shop_id = #{shopId,jdbcType=CHAR}


    </select>



    <select id="getEmployeeCodesByShopId" parameterType="java.lang.String" resultType="java.lang.Integer">

        SELECT
         pe.employee_code employeeCode
        FROM pro_employee pe ,pro_employee_shop ps
        WHERE pe.id=ps.employee_id
        AND pe.dr='N' AND ps.dr='N'
        AND ps.shop_id = #{shopId,jdbcType=CHAR}
    </select>
    <select id="queryEmployeeByShopIds" parameterType="java.util.List" resultMap="positionResultMap">
        select
        pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
        pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
        pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
        pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name,pes.shop_id
        from pro_employee pe ,pro_employee_position pep,pro_position pp ,pro_employee_shop pes
        where pes.shop_id in
        <foreach collection="list" item="shopId" open="(" close=")"
                 separator=",">
            #{shopId}
        </foreach>
        AND pe.id=pep.employee_id AND pep.position_id = pp.id AND pes.employee_id = pe.id
        AND pep.default_position='Y'
        AND pe.dr='N' AND pp.dr='N'
    </select>
    <select id="queryEmployeeByEmployees" parameterType="java.util.List" resultMap="positionResultMap">
        select
        pe.id, pe.hht_member_id, pe.company_id, pe.employee_no, pe.employee_code, pe.employee_name, pe.nationality_id,
        pe.paper_type_id, pe.paper_no, pe.birthday, pe.gender, pe.mobile_no, pe.tel_no, pe.email, pe.home_addr, pe.head_portrait,
        pe.first_entry_time, pe.last_entry_time, pe.last_leave_time, pe.enable,
        pe.locked, pe.locked_reason, pe.remark, pe.dr, pe.ts, pe.version,pp.position_name,pes.shop_id
        from pro_employee pe ,pro_employee_position pep,pro_position pp ,pro_employee_shop pes
        where pe.employee_code in
        <foreach collection="list" item="employeeCode" open="(" close=")"
                 separator=",">
            #{employeeCode}
        </foreach>
        AND pe.id=pep.employee_id
        AND pep.default_position='Y'
        AND pep.position_id = pp.id AND pes.employee_id = pe.id
        AND pe.dr='N' AND pp.dr='N'
    </select>
</mapper>